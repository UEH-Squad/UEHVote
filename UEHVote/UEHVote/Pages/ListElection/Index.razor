@using UEHVote.Models;
@using System.Linq
@attribute [Route(Routes.ListElection)];

<div class="my-election container">
    <h3 >Các cuộc bình chọn</h3>
    <div class="election">
        <table class="election__table">
            <tr class="election__table--header">
                <th class="election__tilte election__tilte--name ">
                    <i class="material-icons me-1">perm_identity</i>
                    <span>TÊN CUỘC BÌNH CHỌN</span>
                </th>
                <th class="election__tilte election__tilte--quantity ">
                    <i class="material-icons-outlined me-1">auto_awesome </i>
                    <span>ĐỀ CỬ</span>
                </th>
                <th class="election__tilte election__tilte--status ">
                    <div class="dropdown">
                        <p class="dropdown-toggle mb-0" href="#" role="button" id="dropdown-status" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="material-icons-outlined me-1">local_offer</i>
                            <span class="me-2 ms-1">TÌNH TRẠNG</span>
                        </p>
                        <ul class="dropdown-menu" aria-labelledby="dropdown-status">
                            @foreach (var status in status)
                            {
                                bool CheckedStatus = false;
                                foreach (var t in result)
                                {
                                    if (t.Status==status)
                                    {
                                        CheckedStatus = true;
                                    }
                                }
                                <li><Checkbox Checked="CheckedStatus" CheckedChanged="eventArgs => { FilterStatus(status, eventArgs.ToString()); }">@status</Checkbox></li>
                            }
                        </ul>
                    </div>
                </th>
                <th class="election__tilte election__tilte--org ">
                    <div class="dropdown">
                        <p class="dropdown-toggle mb-0" href="#" role="button" id="dropdown-org" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="material-icons ">perm_identity</i>
                            <span class="me-2 ms-1">TỔ CHỨC</span>
                        </p>
                        <ul class="dropdown-menu" aria-labelledby="dropdown-org">
                                @if (listOrganizations != null)
                                {
                                    @foreach (var item in listOrganizations)
                                    {
                                        bool Checked = false;
                                        foreach (var t in result)
                                        {
                                            if (t.Org!=null && t.Org.Contains(item.Name))
                                            {
                                                Checked =true;
                                            }  
                                        }
                                        <li><Checkbox Checked="Checked" CheckedChanged="eventArgs => { FilterOrg(item.Name,eventArgs.ToString()); }">@item.Name</Checkbox></li>
                                    }
                                }
                        </ul>
                    </div>
                </th>
            </tr>
        </table>
        <div class="election__table--body">
            <table class="election__table">
                @if (result != null)
                {
                    @foreach (var item in result)
                    {
                        switch (item.Status)
                        {
                            case "ĐANG DIỄN RA":
                                bg = "#06D295";
                                break;
                            case "GẦN KẾT THÚC":
                                bg = "#ECAA00";
                                break;
                            case "KẾT THÚC":
                                bg = "#FF4444";
                                break;
                        }
                        <tr>
                            <td class="election__text election__text--name" onclick="window.location.href='/chi-tiet-de-cu/@item.Id'">@item.Name</td>
                            <td class="election__text election__text--quantity">@item.Quantity</td>
                            <td class="election__text election__text--status"><span style="background-color: @bg">@item.Status</span></td>
                            <td class="election__text election__text--org">@item.Org</td>
                        </tr>
                    }
                }
            </table>
        </div>
    </div>
</div>
